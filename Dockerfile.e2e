# base image with Node.js and playwright preinstalled
FROM mcr.microsoft.com/playwright:v1.44.1-jammy

# set working directory
WORKDIR /srv/apps/atj-platform

# create app directory in the container
RUN mkdir -p /srv/apps/atj-platform

# Install global deps
RUN npm install -g pnpm
RUN npx playwright install --with-deps

# Copy files from local to docker container
COPY . .

# Install project deps
RUN pnpm install --filter=@atj/spotlight
EXPOSE 4321

CMD ["pnpm", "dev", "--filter=@atj/spotlight"]